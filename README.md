## app/main.py
produce_message() - создает продюсера и отправляет сообщение:

Подключается к Kafka на localhost:9092

Создает сообщение "Hello Kafka" в бинарном формате

Отправляет сообщение в топик 'test_topic'

Выводит подтверждение об отправке

consume_message() - создает консьюмера и читает сообщения:

Подключается к тому же топику 'test_topic'

Начинает чтение с самого раннего доступного сообщения (auto_offset_reset='earliest')

Ожидает сообщения максимум 5 секунд (consumer_timeout_ms=5000)

Выводит полученные сообщения с задержкой 1 секунда

Последовательность выполнения:
Отправляет сообщение в Kafka

Ждет 2 секунды (чтобы сообщение успело обработаться)

Читает и выводит сообщение из топика

Требования для работы:
Должен быть запущен Kafka broker на localhost:9092

Должен существовать топик 'test_topic'

Установлены библиотеки: kafka-python


## .gitlab-ci.yml

конфигурационный файл GitLab CI/CD 
Этапы (Stages)

- build
- test  
- deploy

Задача Build

Цель: Сборка Docker-образа приложения

Использует: Docker-in-Docker (dind) для сборки внутри контейнера

Тегирует образ с хэшем коммита ($CI_COMMIT_SHORT_SHA)

Запускается только для ветки master

Задача Test

Цель: Запуск тестов приложения

Использует: Официальный образ Python 3.10.2

Устанавливает зависимости и запускает главный скрипт приложения

Запускается только для ветки master


Задача Deploy

Цель: Развертывание приложения

В текущей версии только выводит сообщение (заглушка)

Запускается только для ветки master

Как работает:

При пуше в ветку master запускается CI/CD конвейер

Выполняются последовательно: сборка → тестирование → развертывание

Каждая задача выполняется в своем Docker-контейнере

Имя образа включает хэш коммита для версионирования

## Dockerfile

Этот код представляет собой Dockerfile - инструкцию для сборки Docker-образа приложения.
FROM python:3.10.2
Базовый образ на основе Python версии 3.10.2

Создает starting point для сборки

2. WORKDIR /app
Устанавливает рабочую директорию внутри контейнера как /app

Все последующие команды будут выполняться из этой папки

3. COPY requirements.txt .
Копирует файл requirements.txt из хоста (локальной машины)

В текущую директорию контейнера (/app)

4. RUN pip install --no-cache-dir -r requirements.txt
Устанавливает Python-зависимости из requirements.txt

Флаг --no-cache-dir предотвращает кэширование для уменьшения размера образа

5. COPY . .
Копирует ВСЕ файлы из текущей директории хоста

В текущую директорию контейнера (/app)

6. CMD [ "python", "app/main.py" ]
Команда по умолчанию при запуске контейнера

Запускает главный скрипт приложения: python app/main.py

Результат выполнения:
Создается Docker-образ, который:

Имеет все необходимые Python-зависимости

Содержит исходный код приложения

При запуске автоматически выполняет app/main.py


## docker-compose.yml

Запускает два сервиса:
ZooKeeper - координационный сервис для Kafka

Kafka - брокер сообщений

Для чего это нужно:
Локальная разработка с Kafka

Тестирование приложений, работающих с messaging

Демонстрационные среды

Интеграционное тестирование

Этот файл создает полноценное Kafka-окружение, готовое к использованию на локальной машине. Приложения могут подключаться к localhost:9092 для работы с Kafka


## my-kafka-dev.yaml

Этот файл представляет собой Kubernetes Deployment манифест для развертывания приложения в Kubernetes-кластере.
Что создается в Kubernetes:
Deployment с именем kafka-demo-app

ReplicaSet для управления репликами

Pod с одним контейнером:

Образ: kafka-demo-app:latest

Открытый порт: 80

1 реплика (один экземпляр приложения)

Как использовать:
Применить манифест: kubectl apply -f deployment.yaml

Проверить статус: kubectl get deployments

Посмотреть pod'ы: kubectl get pods

Особенности:
Одна реплика - приложение запускается в одном экземпляре

Локальный образ (kafka-demo-app:latest) - предполагает, что образ доступен в registry кластера

Порт 80 - приложение слушает на порту 80 внутри контейнера

Это базовый deployment для простых приложений.

## requirements.txt

Файл requirements.txt используется в Python проектах

Содержит список зависимостей (библиотек), необходимых для работы приложения

Описание файлов
